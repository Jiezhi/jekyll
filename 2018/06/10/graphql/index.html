
<!DOCTYPE html>
<html lang="">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Jiezhi Blog">
    <title>graphql简介 - Jiezhi Blog</title>
    <meta name="author" content="Jiezhi">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jiezhi","sameAs":["https://github.com/Jiezhi","https://stackoverflow.com/users/5425709/jiezhi-g","https://twitter.com/JiezhiG","mailto:Jiezhi.Vip+hexo@gmail.com"],"image":"https://www.gravatar.com/avatar/a987dd393c40cf0645bfb4f07b74b334"},"articleBody":"GraphQL会是取代REST API的下一代标准么？\n\n什么是GraphQL\n\nGraphQL是比REST更高效、强大和灵活的新一代API标准。Facebook开发了GraphQL并且将其开源，目前其由一大群来自全球各地的公司和个人维护。\n\n注意到GraphQL是API标准，不要看到QL结尾就以为其是一种数据库技术。\n比REST更灵活的一种选择REST是目前比较流行的一种暴露服务端数据的常见方式，其简化了客户端尤其是移动端和服务器交互的流程。但是随着业务变得复杂，有些情况变得棘手：\n\n移动端数量的增多，对数据的效率要求变高移动端和PC端相比，是需要提高对数据获取的效率的，这个效率就是说要减少网络请求、要减少无用数据的传输。\n\n应对复杂的前端框架和平台现在的情况是仅维护一套API来应对不同框架和平台的请求。PC端一个页面比移动端一个页面展示的内容要多很多，之前后端提供给PC端的API如果直接提供给移动端来使用势必造成资源浪费。所以移动端的人会去找后端的人干一架，结果要么是后端再给移动端单独写一套API，要么就是移动端忍受着API请求返回数据中存在大量冗余的数据。\n\n需要更快速地迭代更新互联网时代最大的特色除了加班也许就是快了。好多公司在喊着小步快跑、快速试错，毕竟市场不等人。然而REST标准的API似乎很难快速地跟上这快跑的节奏。也许一个API刚出来，产品那边已经改了原型，界面重新设计了。这时候就要麻烦后端同学加个班把接口改一下吧。\n\n\n谁在用GraphQL一个产品的流行，肯定是解决了目前的某些痛点。虽然GraqhQL目前在国内还不算流行，可是在美利坚已经有不少巨头在使用了：\nGraphQL vs REST我们来看一下对于不同API标准下，从服务端获取数据的区别。比如在REST API标准下，有三个接口：\n\n/users/该接口返回某用户基本信息\n\n/users//posts该接口返回某用户所有的文章\n\n/users//followers该接口返回某用户所有的关注者\n\n\n\n如图所示，要通过三个不同的请求才能获得某用户及其文章和关注者的信息，其中还存在很多不需要的信息。 \n再看一下GraphQL API的实现：客户端声明自己想要的信息，然后服务端根据请求返回相应的数据\n目前可见的优点：\n\n避免了REST API中常见的信息过多或过少的问题信息过多是指，接口中总会存在客户端不需要的信息，信息过少是指单条接口无法满足客户端需求，需要请求多个接口才能满足需要\n前端可以快速迭代在REST API中，一般都是后端定义好了API，返回固定的数据格式。当前端业务或需求发生变化时，后端很难跟上变动的节奏。如今，业务变化已经难以避免，所以当前端和后端都要相应地作出改动，这样效率势必降低。就我们公司业务来讲，很多情况下，前端一两天的改动如果再拉上后端，人多肯定要开会再加上沟通成本的问题，这个需求没个一周两周很难搞定。设想一下，如果在GraphQL标准下，除非大的改版，后端基本不用出人力来跟着一起需求评审，前端自己定义查询的内容就搞定了。\n\n更深层次地进行分析当客户端可以选择自己想请求数据的内容时，这时候就可以分析出哪些信息是用户感兴趣的，也可以更深层次地分析现有数据是如何被应用的。此外，也可以分析出哪些信息用户不再感兴趣了。\n\nSchema &amp; Type系统的优点GraphQL使用一种强类型系统来定义API，所有的API都通过GraphQL模式定义语言（Schema Definition Language，SDL）来暴露类型数据。而这个模式就是服务端和客户端之间的协议，通过此模式我们可以知道服务端可以提供哪些数据，而客户端又可以获取哪些数据。\n\n\n一旦模式定义好了，前后端就可以据此独立进行开发了。\n核心概念模式定义语言（The Schema Definition Language，SDL）比如这里定义了一个Person类型：\n1234type Person &#123;  name: String!  age: Int!&#125;\nPerson类型又两个字段，name和age，分别为String和Int类型。!表示该字段是必须的。\n同时，两种类型之间可以有关联，比如Person可以和Post关联：\n1234type Post &#123;\ttitle: String!\tauthor: Person!&#125;\n相应的，Person中也可以关联Post类型：\n12345type Person &#123;\tname: String!\tage: Int!\tposts: [Post!]!&#125;\n其中Person和Post是一对多的关系\n通过Queries获取数据在请求数据之前，你需要GraphQL-IDE来模拟下面的请求，有Web版 也有客户端 \n如果你选择了客户端，在启动页面打开这个地址： https://api.graph.cool/simple/v1/cjhvs1vtt4ahm012322aexl4n/\n\n让我们来一个最简单的请求：\n\n12345&#123;  allPersons &#123;    name  &#125;&#125;\n可以看到返回的结果：\n123456789101112131415161718192021&#123;  &quot;data&quot;: &#123;    &quot;allPersons&quot;: [      &#123;        &quot;name&quot;: &quot;Johnny&quot;      &#125;,      &#123;        &quot;name&quot;: &quot;Sarah&quot;      &#125;,      &#123;        &quot;name&quot;: &quot;Alice&quot;      &#125;,      &#123;        &quot;name&quot;: &quot;Bob&quot;      &#125;,      &#123;        &quot;name&quot;: &quot;Alice&quot;      &#125;    ]  &#125;&#125;\n如果我们想在结果里带上age的话：\n123456&#123;  allPersons &#123;    name    age  &#125;&#125;\n\n带参请求同样没问题，可以看到只返回了最后两条数据：\n修改数据这里说的修改包含三种操作：\n\n创建数据\n更新数据\n删除数据\n\n这里以创建数据为例\n123456mutation &#123;  createPerson(name: &quot;Bob&quot;, age: 36) &#123;    name    age  &#125;&#125;\n\n订阅实时更新GraphQL提供了subscriptions的概念来提供给客户端订阅事件。当客户端订阅某事件后，其将会和服务端保持一个稳定的链接。当特定事件触发时，服务端会推送对应的数据给客户端。\n比如我们想订阅新建Person类型事件：\n123456subscription &#123;  newPerson &#123;    name    age  &#125;&#125;\n当有新的Person类型被创建时，客户端就能接收到更新的数据了。\n定义模式模式是GraphQL API中最重要概念之一，其定义了API能提供哪些数据，以及客户端如何获取这些数据。\n有几个特殊的类型被称之为root类型：\n123type Query &#123; ... &#125;type Mutation &#123; ... &#125;type Subscription &#123; ... &#125;\n本文中用到的完整模式定义如下：\n12345678910111213141516171819202122type Query &#123;  allPersons(last: Int): [Person!]!&#125;type Mutation &#123;  createPerson(name: String!, age: Int!): Person!&#125;type Subscription &#123;  newPerson: Person!&#125;type Person &#123;  name: String!  age: Int!  posts: [Post!]!&#125;type Post &#123;  title: String!  author: Person!&#125;\n结语至此，大家应该对GraphQL有一个感性的认识了吧。如果不想仅停留在概念层面，你可以到这里找到目前已经实现的框架。（反正我已经用起来了:P）\n更多内容可访问以下网站：\nhttps://www.graphql.org/https://www.howtographql.com/\n听首音乐放松一下：\n\n\n\nAuthor: Jiezhi.GEmail: Jiezhi.G@gmail.com\n\n欢迎关注我的公众号『日技』\n","dateCreated":"2018-06-10T15:02:51+08:00","dateModified":"2018-10-10T17:25:01+08:00","datePublished":"2018-06-10T15:02:51+08:00","description":"GraphQL会是取代REST API的下一代标准么？","headline":"graphql简介","image":["http://qn-cdn.nospider.net/2018-06-10-graphql.png"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://jiezhi.github.io/2018/06/10/graphql/"},"publisher":{"@type":"Organization","name":"Jiezhi","sameAs":["https://github.com/Jiezhi","https://stackoverflow.com/users/5425709/jiezhi-g","https://twitter.com/JiezhiG","mailto:Jiezhi.Vip+hexo@gmail.com"],"image":"https://www.gravatar.com/avatar/a987dd393c40cf0645bfb4f07b74b334","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/a987dd393c40cf0645bfb4f07b74b334"}},"url":"http://jiezhi.github.io/2018/06/10/graphql/","thumbnailUrl":"http://qn-cdn.nospider.net/2018-06-10-graphql.png"}</script>
    <meta name="description" content="GraphQL会是取代REST API的下一代标准么？">
<meta property="og:type" content="blog">
<meta property="og:title" content="graphql简介">
<meta property="og:url" content="http://jiezhi.github.io/2018/06/10/graphql/index.html">
<meta property="og:site_name" content="Jiezhi Blog">
<meta property="og:description" content="GraphQL会是取代REST API的下一代标准么？">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-graphql.png">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286168671382.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286174419940.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286175800503.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286229140756.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286230297031.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286232389082.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286233483934.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286234981761.jpg">
<meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-15286245421358.jpg">
<meta property="og:image" content="http://qn-jiezhi.nospider.net/qrcode_riji.jpg">
<meta property="og:updated_time" content="2018-10-10T09:25:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="graphql简介">
<meta name="twitter:description" content="GraphQL会是取代REST API的下一代标准么？">
<meta name="twitter:image" content="http://qn-cdn.nospider.net/2018-06-10-graphql.png">
<meta name="twitter:creator" content="@JiezhiG">
    
        <link rel="publisher" href="https://plus.google.com/103408917271477650000"/>
    
    
        
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/d932c72721e71e419028c107423eb812?s=640"/>
    
    
        <meta property="og:image" content="http://qn-cdn.nospider.net/2018-06-10-graphql.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://qn-cdn.nospider.net/2018-06-10-graphql.png" />
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-du2xmrqdqrl2ollgeiw050kpl6l4nbyz7bumjuurjgsxyopifvukebxc9lqe.min.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-67636901-1', 'auto');
        ga('send', 'pageview');
    </script>


    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Jiezhi Blog</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/d932c72721e71e419028c107423eb812?s=90" alt="Bild des Autors"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/d932c72721e71e419028c107423eb812?s=110" alt="Bild des Autors"/>
                </a>
                <h4 class="sidebar-profile-name">Jiezhi</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Kategorien"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Kategorien</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archiv"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archiv</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Suche"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Suche</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="Über"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Über</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/Jiezhi" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://stackoverflow.com/users/5425709/jiezhi-g" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://twitter.com/JiezhiG" target="_blank" rel="noopener" title="Twitter">
                    
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:Jiezhi.Vip+hexo@gmail.com" target="_blank" rel="noopener" title="E-Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">E-Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            graphql简介
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-06-10T15:02:51+08:00">
	
		    10 Jun 2018
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>GraphQL会是取代REST API的下一代标准么？</p>
<a id="more"></a>
<h1 id="什么是GraphQL"><a href="#什么是GraphQL" class="headerlink" title="什么是GraphQL"></a>什么是GraphQL</h1><p><img src="http://qn-cdn.nospider.net/2018-06-10-graphql.png" alt="graphql"></p>
<blockquote>
<p>GraphQL是比REST更高效、强大和灵活的新一代API标准。Facebook开发了GraphQL并且将其开源，目前其由一大群来自全球各地的公司和个人维护。</p>
</blockquote>
<p>注意到GraphQL是API标准，不要看到QL结尾就以为其是一种数据库技术。</p>
<h2 id="比REST更灵活的一种选择"><a href="#比REST更灵活的一种选择" class="headerlink" title="比REST更灵活的一种选择"></a>比REST更灵活的一种选择</h2><p>REST是目前比较流行的一种暴露服务端数据的常见方式，其简化了客户端尤其是移动端和服务器交互的流程。但是随着业务变得复杂，有些情况变得棘手：</p>
<ol>
<li><p>移动端数量的增多，对数据的效率要求变高<br>移动端和PC端相比，是需要提高对数据获取的效率的，这个效率就是说要减少网络请求、要减少无用数据的传输。</p>
</li>
<li><p>应对复杂的前端框架和平台<br>现在的情况是仅维护一套API来应对不同框架和平台的请求。PC端一个页面比移动端一个页面展示的内容要多很多，之前后端提供给PC端的API如果直接提供给移动端来使用势必造成资源浪费。所以移动端的人会去找后端的人干一架，结果要么是后端再给移动端单独写一套API，要么就是移动端忍受着API请求返回数据中存在大量冗余的数据。</p>
</li>
<li><p>需要更快速地迭代更新<br>互联网时代最大的特色除了加班也许就是快了。好多公司在喊着小步快跑、快速试错，毕竟市场不等人。然而REST标准的API似乎很难快速地跟上这快跑的节奏。也许一个API刚出来，产品那边已经改了原型，界面重新设计了。这时候就要麻烦后端同学加个班把接口改一下吧。</p>
</li>
</ol>
<h2 id="谁在用GraphQL"><a href="#谁在用GraphQL" class="headerlink" title="谁在用GraphQL"></a>谁在用GraphQL</h2><p>一个产品的流行，肯定是解决了目前的某些痛点。虽然GraqhQL目前在国内还不算流行，可是在美利坚已经有不少巨头在使用了：</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="http://qn-cdn.nospider.net/2018-06-10-15286168671382.jpg" alt=""></h2><h1 id="GraphQL-vs-REST"><a href="#GraphQL-vs-REST" class="headerlink" title="GraphQL vs REST"></a>GraphQL vs REST</h1><p>我们来看一下对于不同API标准下，从服务端获取数据的区别。比如在REST API标准下，有三个接口：</p>
<ul>
<li><p>/users/<id><br>该接口返回某用户基本信息</id></p>
</li>
<li><p>/users/<id>/posts<br>该接口返回某用户所有的文章</id></p>
</li>
<li><p>/users/<id>/followers<br>该接口返回某用户所有的关注者</id></p>
</li>
</ul>
<p><img src="http://qn-cdn.nospider.net/2018-06-10-15286174419940.jpg" alt=""></p>
<p><em>如图所示，要通过三个不同的请求才能获得某用户及其文章和关注者的信息，其中还存在很多不需要的信息。 </em></p>
<p>再看一下GraphQL API的实现：<br><img src="http://qn-cdn.nospider.net/2018-06-10-15286175800503.jpg" alt=""><br><em>客户端声明自己想要的信息，然后服务端根据请求返回相应的数据</em></p>
<p>目前可见的优点：</p>
<ol>
<li>避免了REST API中常见的信息过多或过少的问题<br>信息过多是指，接口中总会存在客户端不需要的信息，信息过少是指单条接口无法满足客户端需求，需要请求多个接口才能满足需要</li>
<li><p>前端可以快速迭代<br>在REST API中，一般都是后端定义好了API，返回固定的数据格式。当前端业务或需求发生变化时，后端很难跟上变动的节奏。如今，业务变化已经难以避免，所以当前端和后端都要相应地作出改动，这样效率势必降低。就我们公司业务来讲，很多情况下，前端一两天的改动如果再拉上后端，人多肯定要开会再加上沟通成本的问题，这个需求没个一周两周很难搞定。设想一下，如果在GraphQL标准下，除非大的改版，后端基本不用出人力来跟着一起需求评审，前端自己定义查询的内容就搞定了。</p>
</li>
<li><p>更深层次地进行分析<br>当客户端可以选择自己想请求数据的内容时，这时候就可以分析出哪些信息是用户感兴趣的，也可以更深层次地分析现有数据是如何被应用的。<br>此外，也可以分析出哪些信息用户不再感兴趣了。</p>
</li>
<li><p>Schema &amp; Type系统的优点<br>GraphQL使用一种强类型系统来定义API，所有的API都通过GraphQL模式定义语言（Schema Definition Language，SDL）来暴露类型数据。而这个模式就是服务端和客户端之间的协议，通过此模式我们可以知道服务端可以提供哪些数据，而客户端又可以获取哪些数据。</p>
</li>
</ol>
<p>一旦模式定义好了，前后端就可以据此独立进行开发了。</p>
<h1 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h1><h2 id="模式定义语言（The-Schema-Definition-Language，SDL）"><a href="#模式定义语言（The-Schema-Definition-Language，SDL）" class="headerlink" title="模式定义语言（The Schema Definition Language，SDL）"></a>模式定义语言（The Schema Definition Language，SDL）</h2><p>比如这里定义了一个<code>Person</code>类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type Person &#123;</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person类型又两个字段，<code>name</code>和<code>age</code>，分别为<code>String</code>和<code>Int</code>类型。<code>!</code>表示该字段是必须的。</p>
<p>同时，两种类型之间可以有关联，比如<code>Person</code>可以和<code>Post</code>关联：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type Post &#123;</span><br><span class="line">	title: String!</span><br><span class="line">	author: Person!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相应的，<code>Person</code>中也可以关联<code>Post</code>类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type Person &#123;</span><br><span class="line">	name: String!</span><br><span class="line">	age: Int!</span><br><span class="line">	posts: [Post!]!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中<code>Person</code>和<code>Post</code>是一对多的关系</p>
<h2 id="通过Queries获取数据"><a href="#通过Queries获取数据" class="headerlink" title="通过Queries获取数据"></a>通过Queries获取数据</h2><p>在请求数据之前，你需要GraphQL-IDE来模拟下面的请求，有<a href="https://api.graph.cool/simple/v1/cjhvs1vtt4ahm012322aexl4n/?query=%7B%0A%20%20allPersons%20%7B%0A%20%20%20%20name%0A%20%20%7D%0A%7D" target="_blank" rel="noopener">Web版</a> 也有<br><a href="https://github.com/graphcool/graphql-playground" target="_blank" rel="noopener">客户端</a> </p>
<p>如果你选择了客户端，在启动页面打开这个地址： <a href="https://api.graph.cool/simple/v1/cjhvs1vtt4ahm012322aexl4n/" target="_blank" rel="noopener">https://api.graph.cool/simple/v1/cjhvs1vtt4ahm012322aexl4n/</a></p>
<p><img src="http://qn-cdn.nospider.net/2018-06-10-15286229140756.jpg" alt=""></p>
<p>让我们来一个最简单的请求：</p>
<p><img src="http://qn-cdn.nospider.net/2018-06-10-15286230297031.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  allPersons &#123;</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到返回的结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;allPersons&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Johnny&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Sarah&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Alice&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Bob&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Alice&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们想在结果里带上age的话：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  allPersons &#123;</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://qn-cdn.nospider.net/2018-06-10-15286232389082.jpg" alt=""></p>
<h3 id="带参请求"><a href="#带参请求" class="headerlink" title="带参请求"></a>带参请求</h3><p>同样没问题，可以看到只返回了最后两条数据：<br><img src="http://qn-cdn.nospider.net/2018-06-10-15286233483934.jpg" alt=""></p>
<h2 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h2><p>这里说的修改包含三种操作：</p>
<ul>
<li>创建数据</li>
<li>更新数据</li>
<li>删除数据</li>
</ul>
<p>这里以创建数据为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">  createPerson(name: &quot;Bob&quot;, age: 36) &#123;</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://qn-cdn.nospider.net/2018-06-10-15286234981761.jpg" alt=""></p>
<h2 id="订阅实时更新"><a href="#订阅实时更新" class="headerlink" title="订阅实时更新"></a>订阅实时更新</h2><p>GraphQL提供了<code>subscriptions</code>的概念来提供给客户端订阅事件。当客户端订阅某事件后，其将会和服务端保持一个稳定的链接。当特定事件触发时，服务端会推送对应的数据给客户端。</p>
<p>比如我们想订阅新建<code>Person</code>类型事件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">subscription &#123;</span><br><span class="line">  newPerson &#123;</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当有新的Person类型被创建时，客户端就能接收到更新的数据了。</p>
<h2 id="定义模式"><a href="#定义模式" class="headerlink" title="定义模式"></a>定义模式</h2><p>模式是GraphQL API中最重要概念之一，其定义了API能提供哪些数据，以及客户端如何获取这些数据。</p>
<p>有几个特殊的类型被称之为<code>root</code>类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123; ... &#125;</span><br><span class="line">type Mutation &#123; ... &#125;</span><br><span class="line">type Subscription &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>本文中用到的完整模式定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">  allPersons(last: Int): [Person!]!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Mutation &#123;</span><br><span class="line">  createPerson(name: String!, age: Int!): Person!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Subscription &#123;</span><br><span class="line">  newPerson: Person!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Person &#123;</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int!</span><br><span class="line">  posts: [Post!]!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Post &#123;</span><br><span class="line">  title: String!</span><br><span class="line">  author: Person!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>至此，大家应该对GraphQL有一个感性的认识了吧。如果不想仅停留在概念层面，你可以到<a href="https://graphql.org/code/gg" target="_blank" rel="noopener">这里</a>找到目前已经实现的框架。（反正我已经用起来了:P）<br><img src="http://qn-cdn.nospider.net/2018-06-10-15286245421358.jpg" alt=""></p>
<p>更多内容可访问以下网站：</p>
<p><a href="https://www.graphql.org/" target="_blank" rel="noopener">https://www.graphql.org/</a><br><a href="https://www.howtographql.com/" target="_blank" rel="noopener">https://www.howtographql.com/</a></p>
<p><em>听首音乐放松一下</em>：</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=36492681&auto=0&height=66"></iframe>

<blockquote>
<p>Author: Jiezhi.G<br>Email: <a href="mailto:Jiezhi.G@gmail.com" target="_blank" rel="noopener">Jiezhi.G@gmail.com</a></p>
</blockquote>
<p>欢迎关注我的公众号『日技』<br><img src="http://qn-jiezhi.nospider.net/qrcode_riji.jpg" alt=""></p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">FRÜHER</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/03/25/book-app/" data-tooltip="我与阅读" aria-label="NÄCHSTER: 我与阅读">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NÄCHSTER</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://jiezhi.github.io/2018/06/10/graphql/" title="Teilen auf Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://jiezhi.github.io/2018/06/10/graphql/" title="Teilen auf Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://jiezhi.github.io/2018/06/10/graphql/" title="Teilen auf Google Plus">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://jiezhi.github.io/2018/06/10/graphql/" title="Share on Weibo">
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://jiezhi.github.io/2018/06/10/graphql/&amp;title=graphql简介" title="Share on QQ">
                    <i class="fab fa-qq" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://jiezhi.github.io/2018/06/10/graphql/" title="Share on Qzone">
                    <i class="fa fa-star" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=http://jiezhi.github.io/2018/06/10/graphql/" title="Share on Renren">
                    <i class="fab fa-renren" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Jiezhi. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">FRÜHER</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/03/25/book-app/" data-tooltip="我与阅读" aria-label="NÄCHSTER: 我与阅读">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NÄCHSTER</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://jiezhi.github.io/2018/06/10/graphql/" title="Teilen auf Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://jiezhi.github.io/2018/06/10/graphql/" title="Teilen auf Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://jiezhi.github.io/2018/06/10/graphql/" title="Teilen auf Google Plus">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://jiezhi.github.io/2018/06/10/graphql/" title="Share on Weibo">
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://jiezhi.github.io/2018/06/10/graphql/&amp;title=graphql简介" title="Share on QQ">
                    <i class="fab fa-qq" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://jiezhi.github.io/2018/06/10/graphql/" title="Share on Qzone">
                    <i class="fa fa-star" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=http://jiezhi.github.io/2018/06/10/graphql/" title="Share on Renren">
                    <i class="fab fa-renren" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-times"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://jiezhi.github.io/2018/06/10/graphql/">
                    <i class="fab fa-facebook" aria-hidden="true"></i><span>Teilen auf Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://jiezhi.github.io/2018/06/10/graphql/">
                    <i class="fab fa-twitter" aria-hidden="true"></i><span>Teilen auf Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://jiezhi.github.io/2018/06/10/graphql/">
                    <i class="fab fa-google-plus" aria-hidden="true"></i><span>Teilen auf Google Plus</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://jiezhi.github.io/2018/06/10/graphql/">
                    <i class="fab fa-weibo" aria-hidden="true"></i><span>Share on Weibo</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://jiezhi.github.io/2018/06/10/graphql/&amp;title=graphql简介">
                    <i class="fab fa-qq" aria-hidden="true"></i><span>Share on QQ</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://jiezhi.github.io/2018/06/10/graphql/">
                    <i class="fa fa-star" aria-hidden="true"></i><span>Share on Qzone</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=http://jiezhi.github.io/2018/06/10/graphql/">
                    <i class="fab fa-renren" aria-hidden="true"></i><span>Share on Renren</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/d932c72721e71e419028c107423eb812?s=110" alt="Bild des Autors"/>
        
            <h4 id="about-card-name">Jiezhi</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Nanjing China
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-vufjrm3fmbuttogo1hxuu0w9w0sesk5iyysjuguc2hdhufot9szxg8twijry.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'http://jiezhi.github.io/2018/06/10/graphql/';
                 
                    this.page.identifier = '2018/06/10/graphql/';
                 
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'jiezhi';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    



    </body>
</html>
